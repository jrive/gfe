% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gfe.R
\name{gfe}
\alias{gfe}
\title{Grouped Fixed Effects Estimation}
\usage{
gfe(
  formula,
  data,
  index,
  G = NULL,
  itheta = NULL,
  fe = FALSE,
  tune = list(M = 5, J = 10, n = 10),
  method = "wgfe",
  hetslope = FALSE,
  subset = NULL,
  na.action = na.omit,
  parallel = FALSE,
  ncores = parallel::detectCores(logical = FALSE),
  ...
)
}
\arguments{
\item{formula}{A two‐sided \code{formula}, e.g., \code{Y ~ X1 + X2 + ...}.}

\item{data}{A data frame containing the variables in \code{formula} and \code{index}.}

\item{index}{Character vector of length two: \code{c("id_col", "time_col")} identifying panel structure.}

\item{G}{Integer number of groups; if \code{NULL}, groups will be estimated.}

\item{itheta}{Numeric vector of length \eqn{p}, initial slopes; if \code{NULL}, a pooling estimate is used.}

\item{fe}{Logical (default \code{FALSE}); \code{TRUE} to remove individual fixed effects first.}

\item{tune}{List with elements:
\describe{
\item{\code{M}}{number of random starts for VNS (default: 5)}
\item{\code{J}}{maximum number of local iterations per start (default: 10)}
\item{\code{n}}{maximum neighborhood size for random relocations per start (default: 10)}
}}

\item{method}{Character, either \code{"wgfe"} or \code{"gfe"} (default: \code{"wgfe"}).}

\item{hetslope}{Logical (default \code{FALSE}); \code{TRUE} for heterogeneous slopes across groups.}

\item{subset}{An optional vector specifying a subset of observations to use.}

\item{na.action}{Function to handle missing values when building \code{model.frame} (default: \code{na.omit}).}

\item{parallel}{Logical (default \code{FALSE}); \code{TRUE} to run VNS starts in parallel.}

\item{ncores}{Integer number of cores to use if \code{parallel = TRUE} (default: all physical cores).}

\item{...}{Additional arguments (currently unused).}
}
\value{
A list of class \code{gfe} with components:
\describe{
\item{\code{call}}{matched call to this function}
\item{\code{formula}}{the model formula}
\item{\code{model}}{the \code{model.frame} used}
\item{\code{index}}{character vector \code{c("id", "time")}}
\item{\code{terms}}{the \code{terms} object for the design matrix}
\item{\code{theta}}{estimated slope vector (or matrix if heterogeneous)}
\item{\code{group}}{integer vector of final group assignments (length \eqn{N})}
\item{\code{alphas}}{matrix of group‐level intercepts (\eqn{T \times G})}
\item{\code{sigmas}}{numeric vector of group‐specific standard deviations}
\item{\code{residuals}}{vector of unit‐by‐time residuals}
\item{\code{times}}{unique time values}
\item{\code{obj_val}}{numeric, objective value at solution}
\item{\code{gradient}}{numeric gradient of objective at \code{theta} (or \code{NA} on error)}
\item{\code{tune}}{list of tuning parameters used}
\item{\code{fe}}{logical, whether individual fixed effects were removed}
\item{\code{method}}{character, \code{"wgfe"} or \code{"gfe"}}
\item{\code{units}}{unique unit identifiers}
}
}
\description{
Estimate a grouped fixed‐effects model (GFE or WGFE) via variable‐neighborhood search (VNS).
Supports balanced or unbalanced panels and optional individual fixed effects.
}
