% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vns_unbalanced.R
\name{vns_unbalanced}
\alias{vns_unbalanced}
\title{Variable-Neighborhood Search (Unbalanced Panels)}
\usage{
vns_unbalanced(z, theta0, t, params, G, method, hetslope = FALSE)
}
\arguments{
\item{z}{list of length \code{N}, where each element is a \eqn{T \times (p+1)} panel matrix (may contain \code{NA}).}

\item{theta0}{numeric vector of length \code{p}, the initial \eqn{\theta}.}

\item{t}{integer, number of time periods (\code{T}).}

\item{params}{list with elements:
\describe{
\item{\code{J}}{maximum number of local iterations}
\item{\code{n}}{maximum neighborhood size for random relocations}
}}

\item{G}{integer, number of target groups.}

\item{method}{string, either \code{"gfe"} or \code{"wgfe"} to choose the objective.}

\item{hetslope}{logical (default \code{FALSE}); \code{TRUE} for heterogeneous slopes across groups.}
}
\value{
A list with elements:
\describe{
\item{\code{theta}}{estimated \eqn{p}-vector (or \eqn{p \times G} matrix if \code{hetslope=TRUE})}
\item{\code{groups}}{integer vector of length \code{N} with final group assignments}
\item{\code{minimum}}{numeric, the final objective value}
}
}
\description{
Perform one VNS run on unbalanced panels: initialize \code{theta}, then iteratively update group assignments and parameters, handling missing data.
}
