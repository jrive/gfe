% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vns_restricted.R
\name{vns_restricted}
\alias{vns_restricted}
\title{Variable-Neighborhood Search (Restricted WGFE where all variances equal)}
\usage{
vns_restricted(Y, X, t, H, params, init)
}
\arguments{
\item{Y}{numeric vector of length \eqn{N \times T}, stacked by unit (each block of \eqn{t} observations).}

\item{X}{numeric matrix with \eqn{N \times T} rows and \eqn{p} columns of covariates, aligned with \code{Y}.}

\item{t}{integer, number of time periods per unit (\eqn{T}).}

\item{H}{integer, number of groups (\eqn{G}).}

\item{params}{list with elements:
\describe{
\item{\code{M}}{number of random replicates}
\item{\code{J}}{maximum number of local iterations per replicate}
\item{\code{n}}{maximum neighborhood size for random relocations per replicate}
}}

\item{init}{list with components:
\describe{
\item{\code{theta}}{numeric vector of length \eqn{p}, initial slope estimates}
\item{\code{sig}}{numeric vector of length \eqn{G}, initial group‚Äêspecific variances}
}}
}
\value{
A list with elements:
\describe{
\item{\code{theta}}{numeric vector of length \eqn{p}, best slope estimate found}
\item{\code{group}}{integer vector of length \eqn{N}, best group assignments}
\item{\code{opt}}{numeric, best objective value (\eqn{WGFE}-banded SSE) found}
\item{\code{sigma}}{numeric, best overall \eqn{\sigma} estimate}
\item{\code{time}}{difftime object, runtime for the best replicate}
}
}
\description{
Perform one restricted WGFE VNS run over \eqn{M} random starts:
initializes \eqn{\theta}, \eqn{\sigma}, then iteratively updates group assignments and parameters.
Restriction: all group variances must be equal.
}
