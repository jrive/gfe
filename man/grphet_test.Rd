% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/grphet_test.R
\name{grphet_test}
\alias{grphet_test}
\title{Group Variance Heterogeneity Test via Bootstrap}
\usage{
grphet_test(
  object,
  object_gfe,
  M = 10,
  J = 10,
  neigh = 10,
  B = 100,
  cores = parallel::detectCores()
)
}
\arguments{
\item{object}{A fitted \code{wgfe} object (list) containing at least:
\describe{
\item{\code{model}}{the \code{model.frame} used for fitting}
\item{\code{terms}}{the \code{terms} object for constructing the design matrix}
\item{\code{theta}}{numeric vector of estimated slopes}
\item{\code{group}}{integer vector of group assignments of length \eqn{N}}
\item{\code{method}}{character, either \code{"gfe"} or \code{"wgfe"}}
\item{\code{sigmas}}{numeric vector of group‚Äêspecific variances}
\item{\code{fe}}{logical, \code{TRUE} if fixed effects were removed}
}}

\item{object_gfe}{A fitted \code{gfe} object under the null hypothesis (same structure as \code{object}, but using \code{"gfe"} method).}

\item{M}{integer, number of random starts for restricted VNS (default: 10).}

\item{J}{integer, maximum number of local iterations per VNS call (default: 10).}

\item{neigh}{integer, maximum neighborhood size for random relocations per VNS call (default: 10).}

\item{B}{integer, number of bootstrap replicates (default: 100).}

\item{cores}{integer, number of CPU cores to use for parallel processing (default: \code{parallel::detectCores()}).}
}
\value{
A list with elements:
\describe{
\item{\code{J_true}}{numeric, the observed test statistic}
\item{\code{J_bs}}{numeric vector of length \eqn{B}, bootstrap replicates of the test statistic (may contain \code{NA} on error).}
}
}
\description{
Perform a group variance heterogeneity test by comparing WGFE and GFE (criterion-based test):
\enumerate{
\item compute the test statistic under the fitted models,
\item generate bootstrap replicates of the statistic using parallel VNS runs.
}
}
